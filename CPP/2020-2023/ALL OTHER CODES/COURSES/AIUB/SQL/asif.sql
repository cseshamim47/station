CREATE TABLE JAILOR
(
    J_ID NUMBER(15) CONSTRAINT PK_JID PRIMARY KEY,
    J_NAME VARCHAR2(30),
    J_AGE NUMBER(3)
);
DESC JAILOR;

CREATE TABLE CASE
(
    CASE_ID NUMBER(5) CONSTRAINT PK_CASEID PRIMARY KEY,
    CASE_TYPE VARCHAR2(30)
);
DESC CASE;

CREATE TABLE PRISONER
(
    P_ID NUMBER(15) CONSTRAINT PK_PID PRIMARY KEY,
    P_NAME VARCHAR2(30),
    DOB DATE,
    P_AGE NUMBER(3),
    FINGER_PRINT VARCHAR2(5),
    FACE_RECOGNIZE VARCHAR2(5),
    EYE_SCAN VARCHAR2(5),
    ADDRESS VARCHAR2(5),
    GENDER VARCHAR2(10),
    ENTRY_DATE DATE
);

ALTER TABLE PRISONER MODIFY 
(
ADDRESS VARCHAR2(100)
);
DESC PRISONER;


CREATE TABLE CELL
(
    CELL_NUMBER NUMBER(15) CONSTRAINT PK_CELLNUMBER PRIMARY KEY,
    CELL_NAME VARCHAR2(30),
    CAPACITY NUMBER(3),
    P_ID NUMBER(15) CONSTRAINT FK_PID REFERENCES PRISONER
);

DESC CELL;

CREATE TABLE VISITOR
(
    V_ID NUMBER(15) CONSTRAINT PK_VID PRIMARY KEY,
    V_NAME VARCHAR2(30),
    RELATION VARCHAR2(30),
    V_GENDER VARCHAR2(10),
    V_PHONE_NUMBER NUMBER(15),
    V_NID NUMBER(20),
    P_ID NUMBER(15) CONSTRAINT FK_VPID REFERENCES PRISONER,
    J_ID NUMBER(15) CONSTRAINT FK_VJID REFERENCES JAILOR
);
DESC VISITOR;

CREATE TABLE CRIME
(
    CRIME_ID NUMBER(15) CONSTRAINT PK_CRIMEID PRIMARY KEY,
    DATE_IN DATE,
    REMAND VARCHAR2(5),
    CRIME_COUNT NUMBER(5),
    CASE_ID NUMBER(5) CONSTRAINT FK_CCASEID REFERENCES CASE,
    P_ID NUMBER(15) CONSTRAINT FK_CPID REFERENCES PRISONER
);

DESC CRIME;

CREATE TABLE PUNISHMENT
(
    PMENT_NAME VARCHAR2(30),
    PMENT_LOW NUMBER(5),
    PMENT_HIGH NUMBER(5)
);

DESC PUNISHMENT;

INSERT INTO JAILOR VALUES(101,'ASIF AHMED TANJID',30);
INSERT INTO JAILOR VALUES(102,'SUNJIDA KABIR SHEPA',26);
INSERT INTO JAILOR VALUES(103,'ASHRAF HOSSAIN AKASH',31);
INSERT INTO JAILOR VALUES(104,'MAHFUZUR RAHMAN FERDAOUS',29);
INSERT INTO JAILOR VALUES(105,'NAZIA ALFAZ',25);
INSERT INTO JAILOR VALUES(106,'IBSAN KABIR',25);

SELECT * FROM JAILOR;


INSERT INTO CASE VALUES(201,'MURDER');
INSERT INTO CASE VALUES(202,'RAPE');
INSERT INTO CASE VALUES(203,'KIDNAPPING');
INSERT INTO CASE VALUES(204,'ARMED ROBBERY');
INSERT INTO CASE VALUES(205,'INSIDER TRADING');
INSERT INTO CASE VALUES(206,'FRAUD');
INSERT INTO CASE VALUES(207,'EXTORTION');
INSERT INTO CASE VALUES(208,'HARASSMENT');
INSERT INTO CASE VALUES(209,'CYBER BULLYING');
INSERT INTO CASE VALUES(210,'THEFT');

SELECT * FROM CASE;

INSERT INTO PRISONER VALUES(1001,'NAHID HASSAN',TO_DATE( '01 Jan 1999', 'DD MON YYYY'),22,'YES','YES','YES','ROAD 2,JOYPARA,DOHAR,DHAKA,BANGLADESH','MALE',TO_DATE( '01 Jan 1999', 'DD MON YYYY'));
UPDATE PRISONER SET ENTRY_DATE = TO_DATE( '19 Jan 2018', 'DD MON YYYY') WHERE P_ID =1001;
INSERT INTO PRISONER VALUES(1002,'ARMAN ARIF',TO_DATE( '26 Jan 1999', 'DD MON YYYY'),22,'YES','YES','YES','ROAD 3,KHILGAON,DHAKA,BANGLADESH','MALE',TO_DATE( '26 Jan 2017', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1003,'ALI AHMED',TO_DATE( '26 Jan 1998', 'DD MON YYYY'),23,'YES','YES','YES','ROAD 9,RAMPURA,DHAKA,BANGLADESH','MALE',TO_DATE( '27 OCT 2013', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1004,'SAKIB NABI',TO_DATE( '26 JUL 1997', 'DD MON YYYY'),24,'YES','YES','YES','ROAD 7,MOHAMMADPUR,DHAKA,BANGLADESH','MALE',TO_DATE( '27 DEC 2015', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1005,'SAMIO CHEMIYO',TO_DATE( '07 MAY 1998', 'DD MON YYYY'),23,'YES','YES','YES','ROAD 1,SHAJADPUR,DHAKA,BANGLADESH','MALE',TO_DATE( '28 OCT 2016', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1006,'USMAN GHANI',TO_DATE( '07 MAY 1995', 'DD MON YYYY'),26,'YES','YES','YES','ROAD 3,BADDA,DHAKA,BANGLADESH','MALE',TO_DATE( '1 JAN 2012', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1007,'HAFSA ISLAM',TO_DATE( '07 MAR 1998', 'DD MON YYYY'),23,'YES','YES','YES','ROAD 3,BOSHUNDARA,DHAKA,BANGLADESH','FEMALE',TO_DATE( '1 JAN 2019', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1008,'SUMAIYA RAHMAN',TO_DATE( '27 SEP 1996', 'DD MON YYYY'),25,'YES','YES','YES','ROAD 9,MOHAKHALI,DHAKA,BANGLADESH','FEMALE',TO_DATE( '1 FEB 2020', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1009,'NAIMA DEY',TO_DATE( '15 AUG 2000', 'DD MON YYYY'),21,'YES','YES','YES','ROAD 9,SAVAR,DHAKA,BANGLADESH','FEMALE',TO_DATE( '1 MAR 2018', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1010,'MISHA SHOUDAGAR',TO_DATE( '23 SEP 1999', 'DD MON YYYY'),22,'YES','YES','YES','ROAD 9,BANANI,DHAKA,BANGLADESH','MALE',TO_DATE( '11 DEC 2014', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1011,'EMPEROR NIRJHOR',TO_DATE( '27 OCT 1998', 'DD MON YYYY'),23,'YES','YES','YES','ROAD 9,KHILGAON,DHAKA,BANGLADESH','MALE',TO_DATE( '23 SEP 2017', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1012,'EMPEROR JAHANGIR',TO_DATE( '5 MAY 1993', 'DD MON YYYY'),28,'YES','YES','YES','ROAD 2,GULSAN,DHAKA,BANGLADESH','MALE',TO_DATE( '5 SEP 2019', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1013,'RAWNAK MAHIN',TO_DATE( '14 NOV 2000', 'DD MON YYYY'),21,'YES','YES','YES','ROAD 15,MIRPUR,DHAKA,BANGLADESH','MALE',TO_DATE( '01 NOV 2010', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1014,'ARIFUL HAQUE',TO_DATE( '28 NOV 1994', 'DD MON YYYY'),27,'YES','YES','YES','ROAD 19,MUNCHEPPARA,BRAHMANBARIA','MALE',TO_DATE( '27 FEB 2007', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1015,'LABIBA SHAMIM',TO_DATE( '2 APR 1995', 'DD MON YYYY'),26,'YES','YES','YES','ROAD 4,TUNGIPARA,GOPALGONG','FEMALE',TO_DATE( '29 JAN 2003', 'DD MON YYYY'));
INSERT INTO PRISONER VALUES(1016,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
SELECT * FROM PRISONER;
DESC PRISONER;

INSERT INTO VISITOR VALUES(9001,'GOPAL VAR','GRANDFATHER','MALE',01747474747,1919191919,1009,105);
INSERT INTO VISITOR VALUES(9002,'DORAEMON','FRIEND','MALE',01757575757,2929292929,1015,104);
INSERT INTO VISITOR VALUES(9003,'SHINCHAN','BROTHER','MALE',01767676767,3939393939,1011,103);
INSERT INTO VISITOR VALUES(9004,'TOM','COUSIN','MALE',01787878787,4949494949,1013,101);
INSERT INTO VISITOR VALUES(9005,'SHIZUKA','MOM','FEMALE',01797979797,5959595959,1005,102);
SELECT * FROM VISITOR;

INSERT INTO CRIME VALUES(3001,TO_DATE( '15 JAN 2018', 'DD MON YYYY'),'YES',3,202,1001);
INSERT INTO CRIME VALUES(3002,TO_DATE( '2 JAN 2017', 'DD MON YYYY'),'YES',6,201,1002);
INSERT INTO CRIME VALUES(3003,TO_DATE( '15 OCT 2013', 'DD MON YYYY'),'YES',2,208,1003);
INSERT INTO CRIME VALUES(3004,TO_DATE( '12 DEC 2015', 'DD MON YYYY'),'YES',6,203,1004);
INSERT INTO CRIME VALUES(3005,TO_DATE( '20 OCT 2016', 'DD MON YYYY'),'NO',1,206,1005);
INSERT INTO CRIME VALUES(3006,TO_DATE( '15 DEC 2011', 'DD MON YYYY'),'NO',7,209,1006);
INSERT INTO CRIME VALUES(3007,TO_DATE( '17 DEC 2018', 'DD MON YYYY'),'NO',2,206,1007);
INSERT INTO CRIME VALUES(3008,TO_DATE( '25 JAN 2020', 'DD MON YYYY'),'YES',9,210,1008);
INSERT INTO CRIME VALUES(3009,TO_DATE( '21 FEB 2018', 'DD MON YYYY'),'NO',3,206,1009);
INSERT INTO CRIME VALUES(3010,TO_DATE( '01 DEC 2014', 'DD MON YYYY'),'YES',7,207,1010);
INSERT INTO CRIME VALUES(3011,TO_DATE( '14 SEP 2017', 'DD MON YYYY'),'NO',2,205,1011);
INSERT INTO CRIME VALUES(3012,TO_DATE( '01 SEP 2019', 'DD MON YYYY'),'YES',7,204,1012);
INSERT INTO CRIME VALUES(3013,TO_DATE( '19 OCT 2010', 'DD MON YYYY'),'NO',4,210,1013);
INSERT INTO CRIME VALUES(3014,TO_DATE( '12 FEB 2007', 'DD MON YYYY'),'YES',5,203,1014);
INSERT INTO CRIME VALUES(3015,TO_DATE( '20 JAN 2003', 'DD MON YYYY'),'NO',7,210,1015);

SELECT * FROM CRIME;

INSERT INTO CELL VALUES(301,'GG',1,1001);
INSERT INTO CELL VALUES(302,'WP',1,1002);
INSERT INTO CELL VALUES(303,'EZ',1,1003);
INSERT INTO CELL VALUES(304,'ASCP',1,1004);
INSERT INTO CELL VALUES(305,'GM',1,1005);
INSERT INTO CELL VALUES(306,'GGWP',1,1006);
INSERT INTO CELL VALUES(307,'GGEZ',1,1007);
INSERT INTO CELL VALUES(308,'REYNA',1,1008);
INSERT INTO CELL VALUES(309,'SOVA',1,1009);
INSERT INTO CELL VALUES(310,'BRIM',1,1010);
INSERT INTO CELL VALUES(311,'SAGE',1,1011);
INSERT INTO CELL VALUES(312,'PHOENIX',1,1012);
INSERT INTO CELL VALUES(313,'ASTRA',1,1013);
INSERT INTO CELL VALUES(314,'CHAMBER',1,1014);
INSERT INTO CELL VALUES(315,'SKYE',1,1015);
INSERT INTO CELL VALUES(316,'BREACH',1,NULL);
INSERT INTO CELL VALUES(317,'RAZE',1,NULL);
INSERT INTO CELL VALUES(318,'OMEN',1,NULL);
INSERT INTO CELL VALUES(319,'YORU',1,NULL);
INSERT INTO CELL VALUES(320,'KJ',1,NULL);

SELECT * FROM CELL;


INSERT INTO PUNISHMENT VALUES('2 YEARS IMPRISONMENT',1,2);
INSERT INTO PUNISHMENT VALUES('7 YEARS IMPRISONMENT',3,4);
INSERT INTO PUNISHMENT VALUES('LIFETIME IMPRISONMENT',5,7);
INSERT INTO PUNISHMENT VALUES('HANG TILL DEATH',8,10);

SELECT * FROM PUNISHMENT;

SELECT * FROM PRISONER WHERE GENDER = 'FEMALE';
SELECT * FROM PRISONER WHERE P_AGE > 25;
---------------------------
SELECT * FROM JAILOR;
DESC JAILOR;
SELECT * FROM CASE;
DESC CASE;
SELECT * FROM PRISONER;
DESC PRISONER;
SELECT * FROM CELL;
DESC CELL;
SELECT * FROM VISITOR;
DESC VISITOR;
SELECT * FROM CRIME;
DESC CRIME;
SELECT * FROM PUNISHMENT;
DESC PUNISHMENT;
---------------------------------

--- SINGLE ROW FUNCTION QUERY
-- FIND EVERY JAILORS NAME LENGTH
SELECT J_NAME,LENGTH(J_NAME) "NAME LENGTH" FROM JAILOR;

-- MULTI ROW FUCNTION QUERY
-- FIND THE MAXIMUM AND MEAN CRIME OF ALL PRISONERS
SELECT MAX(CRIME_COUNT),ROUND(AVG(CRIME_COUNT)) FROM CRIME;

--- 2 single row sub queries
-- SHOW THE PRISONER INFORMATION WHO'S CELL NUMBER IS 301
SELECT * FROM PRISONER WHERE P_ID = (SELECT P_ID FROM CELL WHERE CELL_NUMBER = 301);

--- GOPAL VAR WENT TO THE PRISON TO SEE HIS GRANDFATHER. A JAILOR IS ASSIGNED TO TAKE HIS INFORMATION. SHOW ALL JAILORS INFORMATION WHO HAS ID NUMBER LESS THAN THAT JAILOR
SELECT * FROM JAILOR WHERE J_ID < (SELECT J_ID FROM VISITOR WHERE V_NAME = 'GOPAL VAR');


--- MULTI ROW SUB QUERIES
--- SHOW ALL THE PRISONERS WHO HAVE DONE 2 CRIMES
SELECT * FROM PRISONER WHERE P_ID IN (SELECT P_ID FROM CRIME WHERE CRIME_COUNT = 2);


---- COMPLEX SUB QUERY 1
--- SHOW ALL THE VISITOR INFORMATION WHO IS GOING TO VISIT FEMALE PRISONERS WHO IS NOT UNDER REMAND 
SELECT * FROM VISITOR WHERE P_ID IN (SELECT P_ID FROM PRISONER WHERE P_ID IN (SELECT P_ID FROM CRIME WHERE REMAND = 'NO') AND GENDER = 'FEMALE');
--- COMPLEX SUB QUERY 2
SELECT * FROM PRISONER WHERE P_ID IN (SELECT P_ID FROM CRIME WHERE CASE_ID = (SELECT CASE_ID FROM CASE WHERE CASE_TYPE = 'MURDER'));

-- EQUI-JOIN QUERY
SELECT P.P_ID,P.P_NAME,C.DATE_IN,CASE.CASE_TYPE,C.CRIME_COUNT FROM PRISONER P, CRIME C,CASE WHERE CASE.CASE_ID = C.CASE_ID AND C.P_ID = P.P_ID;

-- NON EQUI-JOIN 
SELECT P.P_ID,P.P_NAME,PT.PMENT_NAME FROM PUNISHMENT PT, CRIME C, PRISONER P WHERE C.CRIME_COUNT BETWEEN PT.PMENT_LOW AND PT.PMENT_HIGH AND P.P_ID = C.P_ID;

-- VIEW
CREATE OR REPLACE VIEW PRISONERVIEW (PRISONER_ID, PRISONER_NAME, DATE_IN, CASE_TYPE,CRIME_COUNT) AS SELECT P.P_ID,P.P_NAME,C.DATE_IN,CASE.CASE_TYPE,C.CRIME_COUNT FROM PRISONER P, CRIME C,CASE WHERE CASE.CASE_ID = C.CASE_ID AND C.P_ID = P.P_ID;
SELECT * FROM PRISONERVIEW;

--- LEFT OUTER JOIN
SELECT C.CELL_NUMBER,P.P_NAME FROM CELL C LEFT OUTER JOIN PRISONER P ON (C.P_ID = P.P_ID) ORDER BY CELL_NUMBER DESC;

--- RIGHT OUTER JOIN
SELECT NVL2(V.V_NAME,V.V_NAME,'NO VISITOR') "VISTOR NAME",J.J_NAME "JAILOR NAME" FROM VISITOR V RIGHT OUTER JOIN JAILOR J ON (V.J_ID = J.J_ID); 

--- FULL OUTER JOIN
SELECT * FROM PRISONER;
SELECT * FROM CELL;

SELECT P.P_ID,P.P_NAME,C.CELL_NUMBER FROM PRISONER P FULL OUTER JOIN CELL C ON(P.P_ID = C.P_ID);

--- SELF JOIN
SELECT * FROM CRIME;
SELECT A.P_ID,A.CRIME_COUNT,B.P_ID,B.CRIME_COUNT FROM CRIME A,CRIME B WHERE A.P_ID <> B.P_ID AND A.CRIME_COUNT = B.CRIME_COUNT AND A.REMAND = B.REMAND; 